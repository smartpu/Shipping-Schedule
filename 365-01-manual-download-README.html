<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>明日数航 船期网页下载工具使用说明</title>
    <link rel="stylesheet" href="vendor/theme-styles.css">
    <script src="vendor/auth-gist.js"></script>
</head>
<body data-page="365-01-manual-download-README.html">
    <div class="dashboard-container">
        <!-- 左侧导航栏占位容器（将由sidebar-loader.js动态加载） -->
        <div id="sidebar-placeholder"></div>

        <!-- 右侧内容 -->
        <main class="dashboard-content">
            <div class="container">
                <!-- 顶部介绍卡片，沿用 dashboard 风格 -->
                <div class="section-intro">
                    <div class="section-intro-header">
                        <div class="section-intro-content">
                            <h2>明日数航 船期网页下载工具使用说明</h2>
                            <p>辅助手动下载船期网页的工具，提供进度跟踪、状态管理和智能排序功能。</p>
                        </div>
                        <div class="section-intro-actions">
                            <a href="dashboard.html?tab=tools365" class="tool-link" aria-label="返回工具集首页">← 返回首页</a>
                            <a href="365-01-manual-download.html?from=tools365" class="tool-link secondary" aria-label="打开工具">打开工具 →</a>
                        </div>
                    </div>
                </div>

                <!-- 内容区域 -->
                <div class="card-white mt-20">
                    <div class="readme-content">
                        <h2>工具简介</h2>
                        <p>本工具用于从 <strong>hangyun365.com</strong> 网站手动下载船期网页。由于网站有反爬措施，禁止使用自动化工具，因此需要手动操作。工具提供进度跟踪、POL分组、智能排序等功能，让手动下载过程更加高效。</p>
                        <p>⚠️ <strong>重要提示</strong>：建议每保存一个网页后，等待 10 秒再处理下一个，避免请求过快。</p>

                        <hr>

                        <h2>使用步骤</h2>
                        <ol>
                            <li><strong>载入 Excel 文件</strong>：点击"载入 Excel"按钮，选择包含船期数据的 Excel 文件（工作表名称需为"Port Optimization 365"）</li>
                            <li><strong>选择 POL</strong>：在 POL 选项卡中选择要处理的起运港，工具会自动显示该 POL 的所有 URL 列表</li>
                            <li><strong>打开网页</strong>：点击"打开网页"按钮，在新标签页中打开对应网页，等待页面完全加载（约 10 秒）</li>
                            <li><strong>保存网页</strong>：在浏览器中按 <strong>Ctrl+S</strong>（Windows）或 <strong>Cmd+S</strong>（Mac）保存网页到指定文件夹</li>
                            <li><strong>标记进度</strong>：保存完成后，回到工具页面点击"标记为已保存"按钮更新进度</li>
                            <li><strong>继续处理</strong>：重复步骤 3-5，直到所有网页下载完成</li>
                        </ol>

                        <hr>

                        <h2>核心功能</h2>
                        <ul>
                            <li>✅ <strong>Excel 文件加载</strong>：自动解析"Port Optimization 365"工作表</li>
                            <li>✅ <strong>POL 分组显示</strong>：按起运港分组，支持选项卡切换</li>
                            <li>✅ <strong>智能排序</strong>：按照港口列表文件定义的顺序自动排序</li>
                            <li>✅ <strong>进度跟踪</strong>：自动记录已保存状态，刷新后不丢失</li>
                            <li>✅ <strong>统计信息</strong>：实时显示总计、已保存、待处理数量</li>
                            <li>✅ <strong>进度条</strong>：可视化显示当前 POL 的下载进度</li>
                            <li>✅ <strong>重置功能</strong>：点击"已保存"数字可清除当前 POL 的进度</li>
                        </ul>

                        <hr>

                        <h2>数据格式</h2>
                        <h3>Excel 文件要求</h3>
                        <ul>
                            <li><strong>工作表名称</strong>：必须为"Port Optimization 365"</li>
                            <li><strong>A 列（POL）</strong>：起运港信息，格式为 <code>[英文名|代码|中文名]</code></li>
                            <li><strong>B 列（POD）</strong>：目的港信息，格式为 <code>[英文名|代码|区域]</code></li>
                            <li><strong>C 列（POL代码）</strong>：POL 代码，用于判断是否为 CNTAO 或 CNRZH</li>
                            <li><strong>E 列（URL）</strong>：网页链接地址</li>
                        </ul>
                        <h3>排序规则</h3>
                        <p>URL 按照 B 列 POD 中的港口代码进行排序，排序顺序基于 <code>Material-parsed_ports_list.txt</code> 文件中定义的顺序。未知港口会根据区域信息排在该区域的最后。</p>

                        <hr>

                        <h2>常见问题</h2>
                        <h3>Q1: Excel 文件无法自动加载</h3>
                        <p><strong>A</strong>：在本地文件系统环境下，需要手动点击"载入 Excel"按钮选择文件。确保 Excel 文件包含"Port Optimization 365"工作表。</p>

                        <h3>Q2: 打开网页后显示反爬提示</h3>
                        <p><strong>A</strong>：这是正常现象，关闭提示窗口，等待页面完全加载（约 10 秒）后正常保存即可。</p>

                        <h3>Q3: 保存时找不到 365-view-full 文件夹</h3>
                        <p><strong>A</strong>：请确保在项目根目录下的 <code>data</code> 目录中创建了 <code>365-view-full</code> 文件夹，或在保存时手动选择该文件夹。</p>

                        <h3>Q4: 进度丢失</h3>
                        <p><strong>A</strong>：进度保存在浏览器本地存储中。如果清除浏览器数据，进度会丢失，但可以重新标记。建议不要清除浏览器数据。</p>

                        <h3>Q5: 切换 POL 后统计信息变化</h3>
                        <p><strong>A</strong>：这是正常行为。每个 POL 的已保存状态是独立记录的，切换 POL 选项卡时，统计信息会显示当前 POL 的数据。</p>
                    </div>
                </div>

                <!-- 使用声明 -->
                <div class="card-white mt-20">
                    <h2 class="usage-statement-title">明日数航 船期网页下载工具使用声明</h2>
                    <p class="usage-statement-text">本工具仅用于辅助手动下载网页，不涉及任何自动化爬虫功能。所有操作均由用户手动完成，符合网站使用规范。</p>
                    <p class="usage-statement-text">下载的内容仅供内部使用，请遵守相关法律法规和网站使用条款。</p>
                </div>
            </div>
        </main>
    </div>

    <!-- 引入导航栏公共组件 -->
    <script src="vendor/common-utils.js"></script>
    <script src="vendor/debug-utils.js"></script>
    <script src="vendor/sidebar-loader.js"></script>
    <script>
        // 使用公共初始化函数
        init001ToolPage('365-01-manual-download-README.html', 'tools365');
    </script>
</body>
</html>
