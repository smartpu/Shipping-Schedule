<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitor · 运价趋势面板使用说明</title>
    <link rel="stylesheet" href="vendor/theme-styles.css">
    <script src="vendor/auth-gist.js"></script>
</head>
<body data-page="Monitor-Rate-Trends-README.html">
    <div class="dashboard-container">
        <!-- 左侧导航栏占位容器（将由sidebar-loader.js动态加载） -->
        <div id="sidebar-placeholder"></div>

        <!-- 右侧内容 -->
        <main class="dashboard-content">
            <div class="container">
                <!-- 顶部介绍卡片，沿用 dashboard 风格 -->
                <div class="section-intro">
                    <div class="section-intro-header">
                        <div class="section-intro-content">
                            <h2>Monitor · 运价趋势面板使用说明</h2>
                            <p>专业的运价趋势分析与可视化工具，支持 Excel 数据导入、多维度筛选、多种图表展示和 PDF 导出等功能。</p>
                        </div>
                        <div class="section-intro-actions">
                            <a href="dashboard.html?tab=monitor" class="tool-link" aria-label="返回工具集首页">← 返回首页</a>
                            <a href="Monitor-Rate-Trends.html?from=monitor" class="tool-link secondary" aria-label="打开工具">打开工具 →</a>
                        </div>
                    </div>
                </div>

                <!-- 内容区域 -->
                <div class="card-white mt-20">
                    <div class="readme-content">
                        <h2>工具简介</h2>
                        <p><strong>Monitor · 运价趋势面板</strong> 是一款专业的运价趋势分析与可视化工具。支持载入 Excel 文件，通过多维度筛选（时间范围、港口）快速查看和分析运价走势，并提供多种图表展示和 PDF 导出功能。工具主要特点：</p>
                        <ul>
                            <li><strong>Excel 数据导入</strong>：支持载入并解析 Excel 文件，自动识别 D 列日期、F 列港口、G 列运费类型（2SD/4SH）和 H 列运费</li>
                            <li><strong>多维度筛选</strong>：支持按时间范围和港口筛选数据，港口支持多选（以选项卡形式展示）</li>
                            <li><strong>多种图表展示</strong>：筛选区间趋势曲线、全历史周度走势、年度对比同期观察</li>
                            <li><strong>周度涨跌统计</strong>：自动计算并显示周度涨跌情况，包含上上周、上周、本周的对比数据</li>
                            <li><strong>数据摘要卡片</strong>：显示最新、最高、最低的 2SD/4SH 运价数据</li>
                            <li><strong>PDF 导出</strong>：支持导出单个模块或全部模块为 PDF，包含图表和表格</li>
                        </ul>

                        <hr>

                        <h2>快速开始</h2>
                        <h3>前置准备</h3>
                        <ol>
                            <li><strong>Excel 数据文件</strong>：准备包含运价数据的 Excel 文件（需包含 D 列日期、F 列港口、G 列运费类型、H 列运费）</li>
                            <li><strong>浏览器</strong>：推荐使用 Chrome、Edge 或 Safari 浏览器</li>
                        </ol>

                        <h3>基本流程</h3>
                        <ol>
                            <li>打开工具页面</li>
                            <li>工具会自动从 <code>Data/index.json</code> 读取配置并加载对应的 Excel 测试数据文件（如果配置存在）</li>
                            <li>如果自动加载失败或需要手动选择：
                                <ul>
                                    <li>点击"载入 Excel"，载入包含运价数据的 Excel 文件</li>
                                </ul>
                            </li>
                            <li>数据加载成功后，使用筛选器选择时间范围和港口</li>
                            <li>在图表中查看筛选后的运价趋势</li>
                            <li>查看周度涨跌统计表格，了解运价变化情况</li>
                            <li>（可选）点击"导出 PDF"按钮，选择要导出的模块并导出为 PDF</li>
                        </ol>

                        <hr>

                        <h2>核心功能</h2>
                        <h3>1. 数据导入</h3>
                        <ul>
                            <li>支持载入 Excel 文件（.xlsx, .xls 格式）</li>
                            <li>自动识别列结构：D 列日期、F 列港口、G 列运费类型（2SD/4SH）、H 列运费</li>
                            <li>数据仅在本地浏览器解析，不会上传至任何服务器</li>
                        </ul>

                        <h3>2. 多维度筛选</h3>
                        <ul>
                            <li><strong>时间范围筛选</strong>：支持选择开始时间和结束时间，筛选指定时间范围内的数据</li>
                            <li><strong>港口筛选</strong>：
                                <ul>
                                    <li>以选项卡（chips）形式展示所有港口</li>
                                    <li>所有选项卡使用固定宽度（120px），确保对齐对称</li>
                                    <li>支持多选，点击选项卡切换选中状态</li>
                                    <li>未选中的港口悬停时显示蓝色背景和光扫效果</li>
                                    <li>已选中的港口显示蓝色背景和白色文字</li>
                                    <li>港口按指定顺序显示（AEJBA, IQUQS, SAJED 等）</li>
                                </ul>
                            </li>
                            <li><strong>筛选联动</strong>：筛选条件会自动联动，只显示符合所有条件的数据</li>
                        </ul>

                        <h3>3. 图表展示</h3>
                        <ul>
                            <li><strong>筛选区间 · 趋势曲线</strong>：
                                <ul>
                                    <li>显示筛选时间范围内的运价趋势曲线</li>
                                    <li>按港口分组展示，每个港口一条曲线</li>
                                    <li>同时显示 2SD 和 4SH 两种类型的运价</li>
                                    <li>包含数据表格，显示筛选区间的详细数据</li>
                                </ul>
                            </li>
                            <li><strong>全历史 · 周度走势</strong>：
                                <ul>
                                    <li>显示所有历史数据的周度走势</li>
                                    <li>按港口分组展示</li>
                                    <li>支持查看长期趋势</li>
                                </ul>
                            </li>
                            <li><strong>年度对比 · 同期观察</strong>：
                                <ul>
                                    <li>显示不同年份同期的运价对比</li>
                                    <li>支持切换显示 2SD 或 4SH 类型</li>
                                    <li>按港口分组展示</li>
                                </ul>
                            </li>
                        </ul>

                        <h3>4. 周度涨跌统计</h3>
                        <ul>
                            <li>自动计算并显示周度涨跌情况</li>
                            <li>包含上上周、上周、本周的 2SD/4SH 运价数据</li>
                            <li>显示对比上上上周、上上周、上周的变化情况</li>
                            <li>使用颜色标识涨跌（上涨/下跌/持平）</li>
                        </ul>

                        <h3>5. 数据摘要卡片</h3>
                        <ul>
                            <li>显示最新、最高、最低的 2SD/4SH 运价数据</li>
                            <li>每个卡片显示数值、日期和港口信息</li>
                            <li>使用主题颜色系统，数值显示为蓝色</li>
                        </ul>

                        <h3>6. PDF 导出</h3>
                        <ul>
                            <li>支持导出单个模块或全部模块为 PDF</li>
                            <li>可选择的模块包括：
                                <ul>
                                    <li>筛选区间 · 趋势曲线（包含图表和表格）</li>
                                    <li>全历史 · 周度走势（包含图表）</li>
                                    <li>年度对比 · 同期观察（包含图表）</li>
                                    <li>周度涨跌统计（包含表格）</li>
                                    <li>全部模块（导出所有模块）</li>
                                </ul>
                            </li>
                            <li>导出时会自动将图表转换为图片，确保 PDF 中包含完整的图表内容</li>
                            <li>导出文件名包含模块名称和日期</li>
                        </ul>

                        <hr>

                        <h2>数据格式要求</h2>
                        <ul>
                            <li><strong>C 列</strong>：周（周别代码，可选，用于显示）</li>
                            <li><strong>D 列</strong>：日期（支持 Excel 日期序列号和标准日期格式，如 yyyy/mm/dd）</li>
                            <li><strong>F 列</strong>：港口名称（支持任意港口名称）</li>
                            <li><strong>G 列</strong>：运费类型（必须是 "2SD" 或 "4SH"，不区分大小写）</li>
                            <li><strong>H 列</strong>：运费数值（必须是数字）</li>
                        </ul>
                        <p><strong>注意</strong>：</p>
                        <ul>
                            <li>工具使用数组索引读取数据：row[1] = C列（周），row[3] = D列（日期），row[5] = F列（港口），row[6] = G列（类型），row[7] = H列（运费）</li>
                            <li>如果数据缺少日期、港口或运费，该行数据会被自动跳过</li>
                            <li>日期格式支持 Excel 日期序列号（如 45234）和标准日期格式（如 2024/1/1 或 2024-01-01）</li>
                        </ul>

                        <hr>

                        <h2>使用技巧</h2>
                        <ul>
                            <li><strong>快速筛选</strong>：使用时间范围筛选可以快速定位特定时间段的数据</li>
                            <li><strong>多港口对比</strong>：选择多个港口可以同时对比不同港口的运价走势</li>
                            <li><strong>年度对比</strong>：使用年度对比功能可以查看不同年份同期的运价变化</li>
                            <li><strong>PDF 导出</strong>：导出 PDF 时可以选择只导出需要的模块，减少文件大小</li>
                            <li><strong>数据摘要</strong>：查看数据摘要卡片可以快速了解运价的极值情况</li>
                        </ul>

                        <hr>

                        <h2>注意事项</h2>
                        <ul>
                            <li>所有数据仅在本地浏览器解析，不会上传至任何服务器</li>
                            <li>解析结果仅供内部研判，不构成对外报价或投资建议</li>
                            <li>建议使用最新版本的 Chrome、Edge 或 Safari 浏览器以获得最佳体验</li>
                            <li>PDF 导出功能需要加载 html2canvas 和 jsPDF 库，首次导出时可能需要等待库加载完成</li>
                            <li>如果 Excel 文件格式不正确或缺少必要的列，工具会显示错误提示</li>
                        </ul>

                        <hr>

                        <h2>常见问题</h2>
                        <h3>Q: 为什么图表没有显示？</h3>
                        <p>A: 请检查以下几点：</p>
                        <ul>
                            <li>是否已成功加载 Excel 文件</li>
                            <li>是否选择了时间范围和港口</li>
                            <li>筛选后的数据是否为空</li>
                            <li>浏览器控制台是否有错误信息</li>
                        </ul>

                        <h3>Q: PDF 导出失败怎么办？</h3>
                        <p>A: 请检查以下几点：</p>
                        <ul>
                            <li>网络连接是否正常（需要加载 PDF 导出库）</li>
                            <li>浏览器是否支持 PDF 导出功能</li>
                            <li>是否有足够的内存处理大型图表</li>
                            <li>浏览器控制台是否有错误信息</li>
                        </ul>

                        <h3>Q: 港口选项卡没有显示？</h3>
                        <p>A: 请检查以下几点：</p>
                        <ul>
                            <li>是否已成功加载 Excel 文件</li>
                            <li>Excel 文件中是否包含 F 列（港口列）</li>
                            <li>F 列是否有数据</li>
                        </ul>

                        <h3>Q: 日期格式不正确？</h3>
                        <p>A: 工具支持多种日期格式：</p>
                        <ul>
                            <li>Excel 日期序列号（如 45234）</li>
                            <li>标准日期格式（如 2024/1/1 或 2024-01-01）</li>
                            <li>如果日期无法识别，请检查 D 列的数据格式</li>
                        </ul>
                    </div>
                </div>

                <!-- 使用声明 -->
                <div class="card-white mt-20">
                    <h2 class="usage-statement-title">Monitor · 运价趋势面板使用声明</h2>
                    <p class="usage-statement-text">资料整合自用户 Excel 数据，解析结果仅供内部研判，不构成对外报价或投资建议。</p>
                    <p class="usage-statement-text">所有数据仅在本地浏览器解析，不会上传至任何服务器，请放心使用。</p>
                </div>
            </div>
        </main>
    </div>

    <!-- 引入导航栏公共组件 -->
    <script src="vendor/common-utils.js"></script>
    <script src="vendor/debug-utils.js"></script>
    <script src="vendor/sidebar-loader.js"></script>
    <script>
        init001ToolPage('Monitor-Rate-Trends-README.html', 'monitor');
    </script>
</body>
</html>
